- op: replace
  path: /metadata/name
  value: splashofink
- op: add
  path: /spec/template/spec/containers
  value:
    - image: library/ghost:latest
      name: splashofink
      env:
        - name: database__connection__user
          valueFrom:
            secretKeyRef:
              name: splashofinkdb
              key: dbuser
        - name: database__connection__password
          valueFrom:
            secretKeyRef:
              name: splashofinkdb
              key: dbpass
        - name: mail__options__auth__user
          valueFrom:
            secretKeyRef:
              name: mailgun-splashofink
              key: user
        - name: mail__options__auth__pass
          valueFrom:
            secretKeyRef:
              key: pass
              name: mailgun-splashofink
      ports:
        - containerPort: 2368
      volumeMounts:
        - name: splashofink
          mountPath: /var/lib/ghost/content
        - name: splashofink-conf
          mountPath: /var/lib/ghost/config.production.json
          subPath: config.production.json
- op: add
  path: /spec/template/spec/volumes
  value:
    - name: splashofink
      persistentVolumeClaim:
        claimName: splashofink
    - name: splashofink-conf
      configMap:
        name: splashofink-conf
        items:
          - key: production.json
            path: config.production.json
